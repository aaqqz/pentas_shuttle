<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "mybatis-3-mapper.dtd">
<mapper namespace="shuttle.card">

    <select id="getCardList" parameterType="DevMap" resultType="DevMap">
        /* shuttle.card.getCardList */
        SELECT
            CARD_NO
            ,CARD_NAME
            ,CARD_BALANCE
        FROM
            TB_CARD
        WHERE 1=1
        AND CARD_STATE = '01'
        <if test='usrId != null and usrId != ""'>
        </if>
    </select>

    <select id="getHisInfo" parameterType="DevMap" resultType="DevMap">
        /* shuttle.card.getHisInfo */
        SELECT
            USE_STATEMENT_ID
            ,AMOUNT
            ,AMOUNT_TARGET
            ,MERCHANT_ID
            ,APPR_NO
            ,USE_TYPE
            ,to_char(USE_DT, 'YYYY-MM-DD HH:MI:SS') AS USR_DT
        FROM TB_CARD_USE_STATEMENT
        WHERE 1=1
            AND CARD_NO = #{cardNo}
            <if test='useType != "00"'>
                AND USE_TYPE = #{useType}
            </if>
            AND USE_DT BETWEEN TO_DATE(#{sDate}, 'YYYY-MM-DD') AND TO_DATE(#{eDate}, 'YYYY-MM-DD')
    </select>
</mapper>